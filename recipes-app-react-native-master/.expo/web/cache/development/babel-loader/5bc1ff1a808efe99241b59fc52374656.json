{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/home/digggy/hackzurich2020/SeeFood-HackZurich2020/recipes-app-react-native-master/src/screens/Camera/CameraScreen.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport { Camera } from 'expo-camera';\nimport * as Permissions from 'expo-permissions';\n\nvar App = function (_React$Component) {\n  _inherits(App, _React$Component);\n\n  var _super = _createSuper(App);\n\n  function App() {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      hasCameraPermission: false,\n      type: Camera.Constants.Type.back,\n      flashMode: Camera.Constants.FlashMode.off,\n      autoFocus: Camera.Constants.AutoFocus.on,\n      zoom: 0,\n      whiteBalance: Camera.Constants.WhiteBalance.auto,\n      focusDepth: 0,\n      ratio: '16:9'\n    };\n\n    _this._takePictureButtonPressed = function _callee() {\n      var options, photo, uri, width, height, base64;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!_this._cameraInstance) {\n                _context.next = 8;\n                break;\n              }\n\n              options = {\n                quality: 0.1,\n                base64: true\n              };\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(_this._cameraInstance.takePictureAsync(options));\n\n            case 4:\n              photo = _context.sent;\n\n              _this.setState({\n                photo: photo\n              });\n\n              uri = photo.uri, width = photo.width, height = photo.height, base64 = photo.base64;\n              fetch('http://10.15.0.208:5000/process_food', {\n                method: 'post',\n                headers: {\n                  'Accept': 'application/json, text/plain, */*',\n                  'Content-Type': 'application/json'\n                },\n                body: JSON.stringify({\n                  image: base64\n                })\n              }).then(function (res) {\n                return res.json();\n              }).then(function (res) {\n                return console.log(res);\n              });\n\n            case 8:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          hasCameraPermission = _this$state.hasCameraPermission,\n          type = _this$state.type,\n          flashMode = _this$state.flashMode,\n          zoom = _this$state.zoom,\n          whiteBalance = _this$state.whiteBalance,\n          focusDepth = _this$state.focusDepth,\n          photo = _this$state.photo;\n\n      if (!hasCameraPermission) {\n        return React.createElement(View, {\n          style: styles.container,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 30,\n            columnNumber: 14\n          }\n        });\n      }\n\n      return React.createElement(View, {\n        style: styles.container,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 34,\n          columnNumber: 7\n        }\n      }, React.createElement(Camera, {\n        style: styles.camera,\n        ref: function ref(_ref) {\n          return _this2._cameraInstance = _ref;\n        },\n        type: type,\n        flashMode: flashMode,\n        zoom: zoom,\n        whiteBalance: whiteBalance,\n        focusDepth: focusDepth,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 35,\n          columnNumber: 9\n        }\n      }), React.createElement(View, {\n        style: styles.controls,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 9\n        }\n      }, React.createElement(Button, {\n        title: \"Take photo\",\n        onPress: this._takePictureButtonPressed,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46,\n          columnNumber: 11\n        }\n      }), photo && React.createElement(Image, {\n        style: styles.photo,\n        source: photo,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 51,\n          columnNumber: 21\n        }\n      })));\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _await$Permissions$as, status, _await$Permissions$as2, _status;\n\n      return _regeneratorRuntime.async(function componentDidMount$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.prev = 0;\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA));\n\n            case 3:\n              _await$Permissions$as = _context2.sent;\n              status = _await$Permissions$as.status;\n              this.setState({\n                hasCameraPermission: status === 'granted'\n              });\n\n              if (status !== 'granted') {\n                alert('Hey! You might want to enable Camera in your phone settings.');\n              }\n\n              _context2.next = 12;\n              break;\n\n            case 9:\n              _context2.prev = 9;\n              _context2.t0 = _context2[\"catch\"](0);\n              console.log('err', _context2.t0);\n\n            case 12:\n              if (!(Platform.OS === 'android')) {\n                _context2.next = 25;\n                break;\n              }\n\n              _context2.prev = 13;\n              _context2.next = 16;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA_ROLL));\n\n            case 16:\n              _await$Permissions$as2 = _context2.sent;\n              _status = _await$Permissions$as2.status;\n              this.setState({\n                hasCameraPermission: _status === 'granted'\n              });\n\n              if (_status !== 'granted') {\n                alert('Hey! You might want to enable Camera in your phone settings.');\n              }\n\n              _context2.next = 25;\n              break;\n\n            case 22:\n              _context2.prev = 22;\n              _context2.t1 = _context2[\"catch\"](13);\n              console.log('err', _context2.t1);\n\n            case 25:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, this, [[0, 9], [13, 22]], Promise);\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nexport { App as default };\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'black',\n    position: 'relative'\n  },\n  camera: {\n    flex: 1\n  },\n  controls: {\n    position: 'absolute',\n    zIndex: 10,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: 100,\n    justifyContent: 'center',\n    alignItems: 'center'\n  },\n  photo: {\n    width: 100,\n    height: 100,\n    position: 'absolute',\n    right: 0,\n    bottom: 0,\n    top: 0\n  }\n});","map":{"version":3,"sources":["/home/digggy/hackzurich2020/SeeFood-HackZurich2020/recipes-app-react-native-master/src/screens/Camera/CameraScreen.js"],"names":["React","Camera","Permissions","App","state","hasCameraPermission","type","Constants","Type","back","flashMode","FlashMode","off","autoFocus","AutoFocus","on","zoom","whiteBalance","WhiteBalance","auto","focusDepth","ratio","_takePictureButtonPressed","_cameraInstance","options","quality","base64","takePictureAsync","photo","setState","uri","width","height","fetch","method","headers","body","JSON","stringify","image","then","res","json","console","log","styles","container","camera","ref","controls","askAsync","CAMERA","status","alert","Platform","OS","CAMERA_ROLL","Component","StyleSheet","create","flex","backgroundColor","position","zIndex","bottom","left","right","justifyContent","alignItems","top"],"mappings":"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","sourcesContent":["import React from 'react'\nimport { StyleSheet, Text, View, Platform, Button, Image } from 'react-native'\nimport { Camera } from 'expo-camera'\nimport * as Permissions from 'expo-permissions'\n\nexport default class App extends React.Component {\n  state = {\n    hasCameraPermission: false,\n    type: Camera.Constants.Type.back,\n    flashMode: Camera.Constants.FlashMode.off,\n    autoFocus: Camera.Constants.AutoFocus.on,\n    zoom: 0,\n    whiteBalance: Camera.Constants.WhiteBalance.auto,\n    focusDepth: 0,\n    ratio: '16:9',\n  }\n\n  render() {\n    const {\n      hasCameraPermission,\n      type,\n      flashMode,\n      zoom,\n      whiteBalance,\n      focusDepth,\n      photo,\n    } = this.state\n\n    if (!hasCameraPermission) {\n      return <View style={styles.container} />\n    }\n\n    return (\n      <View style={styles.container}>\n        <Camera\n          style={styles.camera}\n          ref={ref => (this._cameraInstance = ref)}\n          type={type}\n          flashMode={flashMode}\n          zoom={zoom}\n          whiteBalance={whiteBalance}\n          focusDepth={focusDepth}\n        />\n\n        <View style={styles.controls}>\n          <Button\n            title=\"Take photo\"\n            onPress={this._takePictureButtonPressed}\n          />\n\n          {photo && <Image style={styles.photo} source={photo} />}\n        </View>\n      </View>\n    )\n  }\n\n  async componentDidMount() {\n    try {\n      const { status } = await Permissions.askAsync(Permissions.CAMERA)\n\n      this.setState({ hasCameraPermission: status === 'granted' })\n\n      if (status !== 'granted') {\n        alert('Hey! You might want to enable Camera in your phone settings.')\n      }\n    } catch (err) {\n      console.log('err', err)\n    }\n\n    if (Platform.OS === 'android') {\n      try {\n        const { status } = await Permissions.askAsync(Permissions.CAMERA_ROLL)\n\n        this.setState({ hasCameraPermission: status === 'granted' })\n\n        if (status !== 'granted') {\n          alert('Hey! You might want to enable Camera in your phone settings.')\n        }\n      } catch (err) {\n        console.log('err', err)\n      }\n    }\n  }\n\n  _takePictureButtonPressed = async () => {\n    if (this._cameraInstance) {\n      const options = { quality: 0.1, base64: true };\n      const photo = await this._cameraInstance.takePictureAsync(options);\n      this.setState({ photo })\n      const { uri, width, height, base64 } = photo;\n      // Post the base54 image data\n      // fetch('10.15.0.208:5000/process_food', {\n      //   method: 'POST',\n      //   headers: {\n      //     Accept: 'application/json',\n      //     'Content-Type': 'application/json',\n      //     'Content-Transfer-Encoding':'base64'\n      //   },\n      //   body: JSON.stringify({\n      //     image: base64\n      //   }),\n      // });\n      //\n\n      // axios({ method: \"post\", url:'',\n      // data: {image: base64},\n      // headers: {\n      //       Accept: 'application/json',\n      //       'Content-Type': 'application/json',\n      //       'Content-Transfer-Encoding':'base64'\n      //     },\n      // })\n      // .then(function (response) {\n      //   console.log(response);\n      // })\n      // .catch(function (error) {\n      //   console.log(error);\n      // });\n\n      //     fetch('https://jsonplaceholder.typicode.com/todos/1')\n      //     .then(response => response.json())\n      //     .then(json => console.log(json))\n      // }\n\n      fetch('http://10.15.0.208:5000/process_food', {\n        method: 'post',\n        headers: {\n          'Accept': 'application/json, text/plain, */*',\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({ image: base64 },)\n      }).then(res => res.json())\n        .then(res => console.log(res));\n\n    }\n  }\n}\n\n\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: 'black',\n    position: 'relative',\n  },\n\n  camera: {\n    flex: 1,\n  },\n\n  controls: {\n    position: 'absolute',\n    zIndex: 10,\n    bottom: 0,\n    left: 0,\n    right: 0,\n    height: 100,\n    justifyContent: 'center',\n    alignItems: 'center',\n  },\n\n  photo: {\n    width: 100,\n    height: 100,\n    position: 'absolute',\n    right: 0,\n    bottom: 0,\n    top: 0,\n  },\n})\n"]},"metadata":{},"sourceType":"module"}